350 Intersection of Two Arrays II
=======================
[Problem description](https://leetcode.com/problems/intersection-of-two-arrays-ii/)

#### Difficulty
<span style="color:green">Easy</span>

#### Keywords
- [Counting](../categories/counting.md)

#### Idea


#### Complexity
- Runtime: O(N)
- Space: O(N)

#### LC performance
- Runtime: 40 ms
- Memory usage: 13.2 MB

#### Code

##### Unsorted arrays
```python
from collections import Counter

class Solution:
    def intersect(self, nums1: List[int], nums2: List[int]) -> List[int]:
        counter = Counter(nums1)
        
        res = []
        for n in nums2:
            if n not in counter:
                continue
            res.append(n)
            counter[n] -= 1
            if counter[n] == 0:
                del counter[n]
                
        return res
```

##### Sorted arrays
```python
class Solution:
    def intersect(self, nums1: List[int], nums2: List[int]) -> List[int]:
        nums1.sort()
        nums2.sort()
        
        # assume `num2` is shorter than `num1`
        if len(nums1) < len (nums2):
            nums1, nums2 = nums2, nums1
        
        def find_left(arr, lo, hi, target):
            """
            Find the left boundary of the target in a sorted array
            """
            if lo == hi:
                return -1
            while lo < hi:
                mid = (lo + hi)//2
                if arr[mid] < target:
                    lo = mid + 1
                else:
                    hi = mid
            return lo if lo < len(arr) and arr[lo] == target else -1
    
        def find_right(arr, lo, hi, target):
            """
            Find the right boundary of the target in a sorted array
            """
            if lo == hi:
                return -1
            while lo < hi:
                mid = (lo + hi)//2
                if arr[mid] > target:
                    hi = mid
                else:
                    lo = mid + 1
            lo -= 1
            return lo if lo >= 0 and arr[lo] == target else -1
        
        # the current position in `nums1` and `nums2`, respectively
        i, j = 0, 0
        res = []
        while j < len(nums2):
            # find the right boundary of `nums2[j]` in `nums2` if it has 
            # duplicates
            l, r = j, find_right(nums2, j, len(nums2), nums2[j])
            # find the left boundary of `nums2[j]` in `nums1`
            ll = find_left(nums1, i, len(nums1), nums2[j])   
            # if `nums2[j]` exists in `nums1`     
            if ll != -1:
                # find the right boundary of it in `nums1`
                i = rr = find_right(nums1, i, len(nums1), nums2[j])
                # only take the smaller number of duplicates for intersection
                res += [nums1[i]] * min(r - l + 1, rr - ll + 1)
            # done with `nums2[j]` and its duplicates and move on to the next 
            # number in `nums2`
            j = r + 1
        
        return res
```
